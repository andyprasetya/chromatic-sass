(function(){var e,t,r,n,o,s,i,u,c;t=require("extend"),e=require("chroma-js"),o=require("node-sass"),u=require("node-sass-utils")(o),c=require("sassport"),n=function(e){return o.types.Color(e[0],e[1],e[2])},i=function(t){return e(t.getR(),t.getG(),t.getB()).rgb()},s=function(t){return e(t.getR(),t.getG(),t.getB()).hex()},r=function(e){var t,r;return t=function(){var t,l,n;for(n=[],r=t=0,l=e.getLength();l>=0?l>t:t>l;r=l>=0?++t:--t)n.push(e.getValue(r));return n}()},module.exports={"chromatic($argslist...)":c.wrap(function(t){return e.lab(l,a,b).hex()}),"chromatic-lab($l, $a, $b)":c.wrap(function(t,r,l){return e.lab(t,r,l).hex()}),"chromatic-hcl($h, $c, $l)":c.wrap(function(t,r,l){return e.hcl(t,r,l).hex()}),"chromatic-mix($color0, $color1, $position: .5, $mode: 'lab')":c.wrap(function(t,r,l,n){return e.mix(s(t),s(r),l,n).hex()}),"chromatic-contrast($color0, $color1)":c.wrap(function(t,r){return e.contrast(s(t),s(r))}),"chromatic-gradient($argslist...)":function(l){var n,i,a,c,g,p,h,f,m,d,b,y,V,$,x,v,O,q,w,L,z,k,C,K,j,B,E,G,J,R,T,U,M,N,S,A,D,F,H,I,P,Q,W,X,Y,Z,_,ee;if(p={mode:"lab",bezier:!1,stops:7,type:"linear",padding:null},h=null,A={},g=[],F=[],m=[],a=l.getLength(),b=l.getValue(0),V=u.typeOf(b),"list"===V?(y=u.castToJs(b),y.every(function(e){return"string"===u.typeOf(e)})&&(h=y.join(" "))):"number"===V?h=b.getValue()+b.getUnit():"string"===V&&(h=b.getValue()),w=l.getValue(a-1),L=u.typeOf(w),"map"===L)for($=O=0,H=w.getLength();H>=0?H>O:O>H;$=H>=0?++O:--O)A[w.getKey($).getValue()]=w.getValue($).getValue();for(Y=t(p,A),Z=h?1:0,d="map"===L?a-1:a,$=q=I=Z,P=d;P>=I?P>q:q>P;$=P>=I?++q:--q)if(n=l.getValue($),i=u.typeOf(n),"list"===i){if(n=r(n),"color"!==u.typeOf(n[0])||"number"!==u.typeOf(n[1])||2!==n.length)return o.types.Error("Chromatic gradient color stops must take the form: <color> [<percentage>]?");if("%"!==n[1].getUnit())return o.types.Error("Chromatic gradient color-stop positions must be provided as percentages");g.push(s(n[0])),F.push(n[1].getValue()/100)}else"color"===i&&(g.push(s(n)),F.push(null));if(F.every(function(e){return null===e}))g=e.scale(g).mode(Y.mode).colors(Y.stops);else{for(m=F.slice(0),null===m[0]&&(m[0]=0),null===m[m.length-1]?m[m.length-1]=1:m[m.length-1]<1&&(g.push(g[g.length-1]),m.push(1),F.push(null)),z=0,N=0,M=0,G=0,v=j=0,k=m.length;k>j;v=++j)if(ee=m[v],null===ee){for(x=0,M+=1,Q=m.slice(v+1,m.length),T=J=0,C=Q.length;C>J;T=++J)if(U=Q[T]){N=T+v-z,x=G>=U?G:1*(U-m[z])/(N+1);break}m[v]=x*M}else M=0,z=v,G>ee?(ee=G,m[v]=ee):ee>G&&(G=ee);for(X=e.scale(g).domain(m).mode(Y.mode);g.length<Y.stops;){for(B=0,E=null,$=S=0,W=g.length-1;W>=0?W>S:S>W;$=W>=0?++S:--S)f=m[$+1]-m[$],f>B&&g[$]!==g[$+1]&&(E=$,B=f);if(null==E)break;R=B/2+m[E],g.splice(E+1,0,X(R).hex()),m.splice(E+1,0,R),F.splice(E+1,0,null)}}for(_=Y.type+"-gradient(",h&&(_+=h+", "),$=D=0,K=g.length;K>D;$=++D)c=g[$],_+=c,null!=F[$]&&(_+=" "+100*F[$]+"%"),$<g.length-1&&(_+=", ");return _+=")",o.types.String(_)},"chromatic-scale($argslist...)":function(r){var l,i,a,c,g,p,h,f,m,d,b,y,V,$,x,v,O,q,w;for(g={mode:"lab",stops:10,bezier:!1,location:null,domain:null},V={},c=[],p=h=0,$=r.getLength();$>=0?$>h:h>$;p=$>=0?++h:--h)if(l=r.getValue(p),i=u.typeOf(l),"map"===i)for(p=f=0,x=l.getLength();x>=0?x>f:f>x;p=x>=0?++f:--f)V[l.getKey(p).getValue()]=l.getValue(p).getValue();else if("list"===i)for(v=u.castToJs(l),b=0,m=v.length;m>b;b++)a=v[b],"color"===u.typeOf(a)&&c.push(s(a));else"color"===i&&c.push(s(l));if(w=t(g,V),w.bezier?q=e.bezier(c).scale():(q=e.scale(c).mode(w.mode),w.domain&&(q=q.domain(w.domain))),w.location)return n(q(w.location).rgb());for(c=q.colors(w.stops),O=o.types.Map(c.length),p=y=0,d=c.length;d>y;p=++y)a=c[p],O.setKey(p,o.types.Number(p)),O.setValue(p,n(e(a).rgb()));return O}}}).call(this);