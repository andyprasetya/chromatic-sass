(function(){var e,t,r,o,n,i,s,u,c;t=require("extend"),e=require("chroma-js"),n=require("node-sass"),u=require("node-sass-utils")(n),c=require("sassport"),o=function(e){return n.types.Color(e[0],e[1],e[2])},s=function(t){return e(t.getR(),t.getG(),t.getB()).rgb()},i=function(t){return e(t.getR(),t.getG(),t.getB()).hex()},r=function(e){var t,r;return t=function(){var t,o,n;for(n=[],r=t=0,o=e.getLength();o>=0?o>t:t>o;r=o>=0?++t:--t)n.push(e.getValue(r));return n}()},module.exports={"chromatic($argslist...)":c.wrap(function(t){return e.lab(l,a,b).hex()}),"chromatic-lab($l, $a, $b)":c.wrap(function(t,r,o){return e.lab(t,r,o).hex()}),"chromatic-hcl($h, $c, $l)":c.wrap(function(t,r,o){return e.hcl(t,r,o).hex()}),"chromatic-mix($color0, $color1, $position: .5, $mode: 'lab')":c.wrap(function(t,r,o,n){return e.mix(i(t),i(r),o,n).hex()}),"chromatic-contrast($color0, $color1)":c.wrap(function(t,r){return e.contrast(i(t),i(r))}),"chromatic-gradient($argslist...)":function(o){var l,a,s,c,g,p,h,f,m,d,b,y,V,$,x,v,O,z,q,w,L,C,K,j,k,B,E,G,J,R,T,U,M,N,S,A,D,F,H,I,P;if(p={mode:"lab",bezier:!1,stops:7,type:"linear",padding:null},h="",U={},g=[],M=[],f=[],s=o.getLength(),d=o.getValue(0),y=u.typeOf(d),"list"===y?(b=u.castToJs(d),b.every(function(e){return"string"===u.typeOf(e)})&&(h=b.join(" "))):"number"===y?h=d.getValue()+d.getUnit():"string"===y&&(h=d.getValue()),z=o.getValue(s-1),q=u.typeOf(z),"map"===q)for(V=v=0,N=z.getLength();N>=0?N>v:v>N;V=N>=0?++v:--v)U[z.getKey(V).getValue()]=z.getValue(V).getValue();for(F=t(p,U),H=h?1:0,m="map"===q?s-1:s,V=O=S=H,A=m;A>=S?A>O:O>A;V=A>=S?++O:--O)if(l=o.getValue(V),a=u.typeOf(l),"list"===a){if(l=r(l),"color"!==u.typeOf(l[0])||"number"!==u.typeOf(l[1])||2!==l.length)return n.types.Error("Chromatic gradient color stops must take the form: <color> [<percentage>]?");if("%"!==l[1].getUnit())return n.types.Error("Chromatic gradient color-stop positions must be provided as percentages");g.push(i(l[0])),M.push(l[1].getValue()/100)}else"color"===a&&(g.push(i(l)),M.push(null));if(!M.every(function(e){return null===e}))for(f=M.slice(0),null===f[0]&&(f[0]=0),null===f[f.length-1]?f[f.length-1]=1:f[f.length-1]<1&&(g.push(g[g.length-1]),f.push(1)),w=0,R=0,J=0,k=0,x=j=0,L=f.length;L>j;x=++j)if(P=f[x],null===P){for($=0,J+=1,D=f.slice(x+1,f.length),E=B=0,C=D.length;C>B;E=++B)if(G=D[E]){R=E+x-w,$=k>=G?k:1*(G-f[w])/(R+1);break}f[x]=$*J}else J=0,w=x,k>P?(P=k,f[x]=P):P>k&&(k=P);for(g=F.bezier?e.bezier(g).scale().colors(F.stops):e.scale(g).mode(F.mode).colors(F.stops),I=F.type+"-gradient(",F.direction&&(I+=F.direction+", "),V=T=0,K=g.length;K>T;V=++T)c=g[V],I+=c,M[V]&&(I+=" "+100*M[V]+"%"),V<g.length-1&&(I+=", ");return I+=")",n.types.String(I)},"chromatic-scale($argslist...)":function(r){var l,a,s,c,g,p,h,f,m,d,b,y,V,$,x,v,O,z,q;for(g={mode:"lab",stops:10,bezier:!1,location:null,domain:null},V={},c=[],p=h=0,$=r.getLength();$>=0?$>h:h>$;p=$>=0?++h:--h)if(l=r.getValue(p),a=u.typeOf(l),"map"===a)for(p=f=0,x=l.getLength();x>=0?x>f:f>x;p=x>=0?++f:--f)V[l.getKey(p).getValue()]=l.getValue(p).getValue();else if("list"===a)for(v=u.castToJs(l),b=0,m=v.length;m>b;b++)s=v[b],"color"===u.typeOf(s)&&c.push(i(s));else"color"===a&&c.push(i(l));if(q=t(g,V),q.bezier?z=e.bezier(c).scale():(z=e.scale(c).mode(q.mode),q.domain&&(z=z.domain(q.domain))),q.location)return o(z(q.location).rgb());for(c=z.colors(q.stops),O=n.types.Map(c.length),p=y=0,d=c.length;d>y;p=++y)s=c[p],O.setKey(p,n.types.Number(p)),O.setValue(p,o(e(s).rgb()));return O}}}).call(this);