(function(){var e,t,o,r,n,s,i,u,c;t=require("extend"),e=require("chroma-js"),n=require("node-sass"),u=require("node-sass-utils")(n),c=require("sassport"),r=function(e){return n.types.Color(e[0],e[1],e[2])},i=function(t){return e(t.getR(),t.getG(),t.getB()).rgb()},s=function(t){return e(t.getR(),t.getG(),t.getB()).hex()},o=function(e){var t,o;return t=function(){var t,l,r;for(r=[],o=t=0,l=e.getLength();l>=0?l>t:t>l;o=l>=0?++t:--t)r.push(e.getValue(o));return r}()},module.exports={"chromatic($argslist...)":c.wrap(function(t){return e.lab(l,a,b).hex()}),"chromatic-lab($l, $a, $b)":c.wrap(function(t,o,l){return e.lab(t,o,l).hex()}),"chromatic-hcl($h, $c, $l)":c.wrap(function(t,o,l){return e.hcl(t,o,l).hex()}),"chromatic-mix($color0, $color1, $position: .5, $mode: 'lab')":c.wrap(function(t,o,l,r){return e.mix(s(t),s(o),l,r).hex()}),"chromatic-contrast($color0, $color1)":c.wrap(function(t,o){return e.contrast(s(t),s(o))}),"chromatic-gradient($argslist...)":function(l){var r,i,a,c,g,p,h,f,m,d,b,y,V,$,x,v,O,w,q,L,z,k,C,K,M,N,j,B,E,G,J,R,T,U,S,A,D,F,H,I,P,Q,W,X,Y,Z,_,ee;if(p={mode:"lab",bezier:!1,stops:7,type:"linear",padding:null},h=null,A={},g=[],F=[],m=[],a=l.getLength(),b=l.getValue(0),V=u.typeOf(b),"list"===V?(y=u.castToJs(b),y.every(function(e){return"string"===u.typeOf(e)})&&(h=y.join(" "))):"number"===V?h=b.getValue()+b.getUnit():"string"===V&&(h=b.getValue()),q=l.getValue(a-1),L=u.typeOf(q),"map"===L)for($=O=0,H=q.getLength();H>=0?H>O:O>H;$=H>=0?++O:--O)A[q.getKey($).getValue()]=q.getValue($).getValue();for(Y=t(p,A),Z=h?1:0,d="map"===L?a-1:a,$=w=I=Z,P=d;P>=I?P>w:w>P;$=P>=I?++w:--w)if(r=l.getValue($),i=u.typeOf(r),"list"===i){if(r=o(r),"color"!==u.typeOf(r[0])||"number"!==u.typeOf(r[1])||2!==r.length)return n.types.Error("Chromatic gradient color stops must take the form: <color> [<percentage>]?");if("%"!==r[1].getUnit())return n.types.Error("Chromatic gradient color-stop positions must be provided as percentages");g.push(s(r[0])),F.push(r[1].getValue()/100)}else"color"===i&&(g.push(s(r)),F.push(null));if(F.every(function(e){return null===e}))g=e.scale(g).mode(Y.mode).colors(Y.stops);else{for(m=F.slice(0),null===m[0]&&(m[0]=0),null===m[m.length-1]?m[m.length-1]=1:m[m.length-1]<1&&(g.push(g[g.length-1]),m.push(1),F.push(null)),z=0,U=0,T=0,B=0,v=M=0,k=m.length;k>M;v=++M)if(ee=m[v],null===ee){for(x=0,T+=1,Q=m.slice(v+1,m.length),J=E=0,C=Q.length;C>E;J=++E)if(R=Q[J]){U=J+v-z,x=B>=R?B:1*(R-m[z])/(U+1);break}m[v]=x*T}else T=0,z=v,B>ee?(ee=B,m[v]=ee):ee>B&&(B=ee);for(X=e.scale(g).domain(m).mode(Y.mode),console.log(Y);g.length<Y.stops;){for(console.log(g),console.log(m),N=0,j=null,$=S=0,W=g.length-1;W>=0?W>S:S>W;$=W>=0?++S:--S)f=m[$+1]-m[$],f>N&&g[$]!==g[$+1]&&(j=$,N=f);if(null==j)break;G=N/2+m[j],g.splice(j+1,0,X(G).hex()),m.splice(j+1,0,G),F.splice(j+1,0,null),console.log("Max distance: "+N),console.log("Max distance start index: "+j),console.log("New color: "+X(G).hex()),console.log("New position: "+G)}console.log(g),console.log(m)}for(_=Y.type+"-gradient(",h&&(_+=h+", "),$=D=0,K=g.length;K>D;$=++D)c=g[$],_+=c,null!=F[$]&&(_+=" "+100*F[$]+"%"),$<g.length-1&&(_+=", ");return _+=")",n.types.String(_)},"chromatic-scale($argslist...)":function(o){var l,i,a,c,g,p,h,f,m,d,b,y,V,$,x,v,O,w,q;for(g={mode:"lab",stops:10,bezier:!1,location:null,domain:null},V={},c=[],p=h=0,$=o.getLength();$>=0?$>h:h>$;p=$>=0?++h:--h)if(l=o.getValue(p),i=u.typeOf(l),"map"===i)for(p=f=0,x=l.getLength();x>=0?x>f:f>x;p=x>=0?++f:--f)V[l.getKey(p).getValue()]=l.getValue(p).getValue();else if("list"===i)for(v=u.castToJs(l),b=0,m=v.length;m>b;b++)a=v[b],"color"===u.typeOf(a)&&c.push(s(a));else"color"===i&&c.push(s(l));if(q=t(g,V),q.bezier?w=e.bezier(c).scale():(w=e.scale(c).mode(q.mode),q.domain&&(w=w.domain(q.domain))),q.location)return r(w(q.location).rgb());for(c=w.colors(q.stops),O=n.types.Map(c.length),p=y=0,d=c.length;d>y;p=++y)a=c[p],O.setKey(p,n.types.Number(p)),O.setValue(p,r(e(a).rgb()));return O}}}).call(this);